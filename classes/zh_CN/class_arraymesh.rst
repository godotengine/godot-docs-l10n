:github_url: hide

.. Generated automatically by doc/tools/make_rst.py in Godot's source tree.
.. DO NOT EDIT THIS FILE, but the ArrayMesh.xml source instead.
.. The source is found in doc/classes or modules/<name>/doc_classes.

.. _class_ArrayMesh:

ArrayMesh
=========

**Inherits:** :ref:`Mesh<class_Mesh>` **<** :ref:`Resource<class_Resource>` **<** :ref:`Reference<class_Reference>` **<** :ref:`Object<class_Object>`

:ref:`Mesh<class_Mesh>` 网格类型，提供了用于从数组构造表面的工具。

描述
----

``ArrayMesh`` 是用来构造 :ref:`Mesh<class_Mesh>` 的，其属性指定为数组。

最基本的例子是创建单个三角形：

::

    var vertices = PoolVector3Array()
    vertices.push_back(Vector3(0, 1, 0))
    vertices.push_back(Vector3(1, 0, 0))
    vertices.push_back(Vector3(0, 0, 1))
    # 初始化 ArrayMesh。
    var arr_mesh = ArrayMesh.new()
    var arrays = []
    arrays.resize(ArrayMesh.ARRAY_MAX)
    arrays[ArrayMesh.ARRAY_VERTEX] = vertices
    # 创建 Mesh。
    arr_mesh.add_surface_from_arrays(Mesh.PRIMITIVE_TRIANGLES, arrays)
    var m = MeshInstance.new()
    m.mesh = arr_mesh

这个 :ref:`MeshInstance<class_MeshInstance>` 已经准备就绪，以添加到要显示的 :ref:`SceneTree<class_SceneTree>` 中。

程序式几何体生成，请参阅 :ref:`ImmediateGeometry<class_ImmediateGeometry>`\ 、\ :ref:`MeshDataTool<class_MeshDataTool>`\ 、\ :ref:`SurfaceTool<class_SurfaceTool>`\ 。

\ **注意：**\ Godot 对三角形基本网格模式的正面使用顺时针\ `环绕顺序 <https://learnopengl.com/Advanced-OpenGL/Face-culling>`__\ 。

教程
----

- :doc:`../tutorials/3d/procedural_geometry/arraymesh`

属性
----

+-------------------------------------------------+--------------------------------------------------------------------+------------------------------+
| :ref:`BlendShapeMode<enum_Mesh_BlendShapeMode>` | :ref:`blend_shape_mode<class_ArrayMesh_property_blend_shape_mode>` | ``1``                        |
+-------------------------------------------------+--------------------------------------------------------------------+------------------------------+
| :ref:`AABB<class_AABB>`                         | :ref:`custom_aabb<class_ArrayMesh_property_custom_aabb>`           | ``AABB( 0, 0, 0, 0, 0, 0 )`` |
+-------------------------------------------------+--------------------------------------------------------------------+------------------------------+

方法
----

+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                                          | :ref:`add_blend_shape<class_ArrayMesh_method_add_blend_shape>` **(** :ref:`String<class_String>` name **)**                                                                                                                                                                     |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                                          | :ref:`add_surface_from_arrays<class_ArrayMesh_method_add_surface_from_arrays>` **(** :ref:`PrimitiveType<enum_Mesh_PrimitiveType>` primitive, :ref:`Array<class_Array>` arrays, :ref:`Array<class_Array>` blend_shapes=[  ], :ref:`int<class_int>` compress_flags=2194432 **)** |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                                          | :ref:`clear_blend_shapes<class_ArrayMesh_method_clear_blend_shapes>` **(** **)**                                                                                                                                                                                                |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                                          | :ref:`clear_surfaces<class_ArrayMesh_method_clear_surfaces>` **(** **)**                                                                                                                                                                                                        |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :ref:`int<class_int>`                         | :ref:`get_blend_shape_count<class_ArrayMesh_method_get_blend_shape_count>` **(** **)** |const|                                                                                                                                                                                  |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :ref:`String<class_String>`                   | :ref:`get_blend_shape_name<class_ArrayMesh_method_get_blend_shape_name>` **(** :ref:`int<class_int>` index **)** |const|                                                                                                                                                        |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :ref:`Error<enum_@GlobalScope_Error>`         | :ref:`lightmap_unwrap<class_ArrayMesh_method_lightmap_unwrap>` **(** :ref:`Transform<class_Transform>` transform, :ref:`float<class_float>` texel_size **)**                                                                                                                    |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                                          | :ref:`regen_normalmaps<class_ArrayMesh_method_regen_normalmaps>` **(** **)**                                                                                                                                                                                                    |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                                          | :ref:`set_blend_shape_name<class_ArrayMesh_method_set_blend_shape_name>` **(** :ref:`int<class_int>` index, :ref:`String<class_String>` name **)**                                                                                                                              |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :ref:`int<class_int>`                         | :ref:`surface_find_by_name<class_ArrayMesh_method_surface_find_by_name>` **(** :ref:`String<class_String>` name **)** |const|                                                                                                                                                   |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :ref:`int<class_int>`                         | :ref:`surface_get_array_index_len<class_ArrayMesh_method_surface_get_array_index_len>` **(** :ref:`int<class_int>` surf_idx **)** |const|                                                                                                                                       |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :ref:`int<class_int>`                         | :ref:`surface_get_array_len<class_ArrayMesh_method_surface_get_array_len>` **(** :ref:`int<class_int>` surf_idx **)** |const|                                                                                                                                                   |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :ref:`int<class_int>`                         | :ref:`surface_get_format<class_ArrayMesh_method_surface_get_format>` **(** :ref:`int<class_int>` surf_idx **)** |const|                                                                                                                                                         |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :ref:`String<class_String>`                   | :ref:`surface_get_name<class_ArrayMesh_method_surface_get_name>` **(** :ref:`int<class_int>` surf_idx **)** |const|                                                                                                                                                             |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :ref:`PrimitiveType<enum_Mesh_PrimitiveType>` | :ref:`surface_get_primitive_type<class_ArrayMesh_method_surface_get_primitive_type>` **(** :ref:`int<class_int>` surf_idx **)** |const|                                                                                                                                         |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                                          | :ref:`surface_remove<class_ArrayMesh_method_surface_remove>` **(** :ref:`int<class_int>` surf_idx **)**                                                                                                                                                                         |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                                          | :ref:`surface_set_name<class_ArrayMesh_method_surface_set_name>` **(** :ref:`int<class_int>` surf_idx, :ref:`String<class_String>` name **)**                                                                                                                                   |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                                          | :ref:`surface_update_region<class_ArrayMesh_method_surface_update_region>` **(** :ref:`int<class_int>` surf_idx, :ref:`int<class_int>` offset, :ref:`PoolByteArray<class_PoolByteArray>` data **)**                                                                             |
+-----------------------------------------------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

枚举
----

.. _enum_ArrayMesh_ArrayType:

.. _class_ArrayMesh_constant_ARRAY_VERTEX:

.. _class_ArrayMesh_constant_ARRAY_NORMAL:

.. _class_ArrayMesh_constant_ARRAY_TANGENT:

.. _class_ArrayMesh_constant_ARRAY_COLOR:

.. _class_ArrayMesh_constant_ARRAY_TEX_UV:

.. _class_ArrayMesh_constant_ARRAY_TEX_UV2:

.. _class_ArrayMesh_constant_ARRAY_BONES:

.. _class_ArrayMesh_constant_ARRAY_WEIGHTS:

.. _class_ArrayMesh_constant_ARRAY_INDEX:

.. _class_ArrayMesh_constant_ARRAY_MAX:

enum **ArrayType**:

- **ARRAY_VERTEX** = **0** --- :ref:`PoolVector3Array<class_PoolVector3Array>`, :ref:`PoolVector2Array<class_PoolVector2Array>`, 或\ :ref:`Array<class_Array>`\ 的顶点位置。

- **ARRAY_NORMAL** = **1** --- :ref:`PoolVector3Array<class_PoolVector3Array>` 顶点法线。

- **ARRAY_TANGENT** = **2** --- 顶点切线的\ :ref:`PoolRealArray<class_PoolRealArray>`\ 。每个元素以4个浮点数为一组，前3个浮点数决定切线，最后一个是-1或1的双法线方向。

- **ARRAY_COLOR** = **3** --- :ref:`PoolColorArray<class_PoolColorArray>` 顶点颜色。

- **ARRAY_TEX_UV** = **4** --- :ref:`PoolVector2Array<class_PoolVector2Array>` 用于UV坐标。

- **ARRAY_TEX_UV2** = **5** --- :ref:`PoolVector2Array<class_PoolVector2Array>`\ 用于第二UV坐标。

- **ARRAY_BONES** = **6** --- :ref:`PoolRealArray<class_PoolRealArray>`\ 或\ :ref:`PoolIntArray<class_PoolIntArray>`\ 的骨骼索引。每个元素以4个浮点数为一组。

- **ARRAY_WEIGHTS** = **7** --- 骨骼权重的\ :ref:`PoolRealArray<class_PoolRealArray>`\ 。每个元素以4个浮点数为一组。

- **ARRAY_INDEX** = **8** --- :ref:`PoolIntArray<class_PoolIntArray>`\ 整数数组，用作引用顶点、颜色、法线、切线和纹理的索引。所有这些数组必须具有与顶点数组相同的元素数量。任何索引都不能超过顶点数组的大小。当这个索引数组出现时，它使函数进入“索引模式”，其中索引选择 \*i\* 的顶点、法线、切线、颜色、UV 等。这意味着如果你想沿着一条边有不同的法线或颜色，需拷贝顶点。

对于三角形，索引数组被解释为三元组，指的是每个三角形的顶点。对于线，索引数组是成对的，表示每条线的起点和终点。

- **ARRAY_MAX** = **9** --- 表示\ :ref:`ArrayType<enum_ArrayMesh_ArrayType>`\ 枚举的大小。

----

.. _enum_ArrayMesh_ArrayFormat:

.. _class_ArrayMesh_constant_ARRAY_FORMAT_VERTEX:

.. _class_ArrayMesh_constant_ARRAY_FORMAT_NORMAL:

.. _class_ArrayMesh_constant_ARRAY_FORMAT_TANGENT:

.. _class_ArrayMesh_constant_ARRAY_FORMAT_COLOR:

.. _class_ArrayMesh_constant_ARRAY_FORMAT_TEX_UV:

.. _class_ArrayMesh_constant_ARRAY_FORMAT_TEX_UV2:

.. _class_ArrayMesh_constant_ARRAY_FORMAT_BONES:

.. _class_ArrayMesh_constant_ARRAY_FORMAT_WEIGHTS:

.. _class_ArrayMesh_constant_ARRAY_FORMAT_INDEX:

enum **ArrayFormat**:

- **ARRAY_FORMAT_VERTEX** = **1** --- 数组格式将包括顶点（必填）。

- **ARRAY_FORMAT_NORMAL** = **2** --- 数组格式将包括法线。

- **ARRAY_FORMAT_TANGENT** = **4** --- 数组格式将包括切线。

- **ARRAY_FORMAT_COLOR** = **8** --- 数组格式将包括一个颜色数组。

- **ARRAY_FORMAT_TEX_UV** = **16** --- 数组格式将包括UV。

- **ARRAY_FORMAT_TEX_UV2** = **32** --- 数组格式将包括另一组 UV。

- **ARRAY_FORMAT_BONES** = **64** --- 数组格式将包括骨骼索引。

- **ARRAY_FORMAT_WEIGHTS** = **128** --- 数组格式将包括骨骼权重。

- **ARRAY_FORMAT_INDEX** = **256** --- 将使用索引数组。

常量
----

.. _class_ArrayMesh_constant_NO_INDEX_ARRAY:

.. _class_ArrayMesh_constant_ARRAY_WEIGHTS_SIZE:

- **NO_INDEX_ARRAY** = **-1** --- 当没有索引时，index_array_len的默认值。

- **ARRAY_WEIGHTS_SIZE** = **4** --- 每个顶点的权重/骨指数量（始终为 4）。

属性说明
--------

.. _class_ArrayMesh_property_blend_shape_mode:

- :ref:`BlendShapeMode<enum_Mesh_BlendShapeMode>` **blend_shape_mode**

+-----------+-----------------------------+
| *Default* | ``1``                       |
+-----------+-----------------------------+
| *Setter*  | set_blend_shape_mode(value) |
+-----------+-----------------------------+
| *Getter*  | get_blend_shape_mode()      |
+-----------+-----------------------------+

将混合形状模式设置为\ :ref:`BlendShapeMode<enum_Mesh_BlendShapeMode>`\ 之一。

----

.. _class_ArrayMesh_property_custom_aabb:

- :ref:`AABB<class_AABB>` **custom_aabb**

+-----------+------------------------------+
| *Default* | ``AABB( 0, 0, 0, 0, 0, 0 )`` |
+-----------+------------------------------+
| *Setter*  | set_custom_aabb(value)       |
+-----------+------------------------------+
| *Getter*  | get_custom_aabb()            |
+-----------+------------------------------+

用用户定义的用于使用视锥剔除的一种替代\ :ref:`AABB<class_AABB>`\ 。在使用着色器偏移顶点时，避免非预期的剔除特别有用。

方法说明
--------

.. _class_ArrayMesh_method_add_blend_shape:

- void **add_blend_shape** **(** :ref:`String<class_String>` name **)**

为混合形状添加名称，该名称将用\ :ref:`add_surface_from_arrays<class_ArrayMesh_method_add_surface_from_arrays>`\ 添加。必须在添加曲面之前调用。

----

.. _class_ArrayMesh_method_add_surface_from_arrays:

- void **add_surface_from_arrays** **(** :ref:`PrimitiveType<enum_Mesh_PrimitiveType>` primitive, :ref:`Array<class_Array>` arrays, :ref:`Array<class_Array>` blend_shapes=[  ], :ref:`int<class_int>` compress_flags=2194432 **)**

创建一个新的面。

创建面是为了使用 ``primitive`` 进行渲染，可以是 :ref:`PrimitiveType<enum_Mesh_PrimitiveType>` 中定义的任何类型。（注意，当使用索引时，建议只使用点、线或三角形）。\ :ref:`Mesh.get_surface_count<class_Mesh_method_get_surface_count>` 的值将成为这个新面的 ``surface_idx`` 索引。

\ ``arrays`` 参数是数组的数组。关于这个数组中使用的值，请参阅 :ref:`ArrayType<enum_ArrayMesh_ArrayType>`\ 。例如，\ ``arrays[0]`` 是顶点的数组。总是需要第一个顶点子数组，其他的可选。添加一个索引数组使这个函数进入“索引模式”，顶点和其他数组作为数据来源，索引数组定义其顶点顺序。所有的子数组必须与顶点数组具有相同的长度，或者为空，如果使用了 :ref:`ARRAY_INDEX<class_ArrayMesh_constant_ARRAY_INDEX>` 时除外。

----

.. _class_ArrayMesh_method_clear_blend_shapes:

- void **clear_blend_shapes** **(** **)**

删除此\ ``ArrayMesh``\ 的所有混合形状。

----

.. _class_ArrayMesh_method_clear_surfaces:

- void **clear_surfaces** **(** **)**

删除此\ ``ArrayMesh``\ 的所有表面。

----

.. _class_ArrayMesh_method_get_blend_shape_count:

- :ref:`int<class_int>` **get_blend_shape_count** **(** **)** |const|

返回\ ``ArrayMesh``\ 持有的混合形状的数量。

----

.. _class_ArrayMesh_method_get_blend_shape_name:

- :ref:`String<class_String>` **get_blend_shape_name** **(** :ref:`int<class_int>` index **)** |const|

返回此索引处的混合形状的名称。

----

.. _class_ArrayMesh_method_lightmap_unwrap:

- :ref:`Error<enum_@GlobalScope_Error>` **lightmap_unwrap** **(** :ref:`Transform<class_Transform>` transform, :ref:`float<class_float>` texel_size **)**

将在\ ``ArrayMesh``\ 上执行UV展开，以准备用于光照贴图的网格。

----

.. _class_ArrayMesh_method_regen_normalmaps:

- void **regen_normalmaps** **(** **)**

将为\ ``ArrayMesh``\ 重新生成法线图。

----

.. _class_ArrayMesh_method_set_blend_shape_name:

- void **set_blend_shape_name** **(** :ref:`int<class_int>` index, :ref:`String<class_String>` name **)**

----

.. _class_ArrayMesh_method_surface_find_by_name:

- :ref:`int<class_int>` **surface_find_by_name** **(** :ref:`String<class_String>` name **)** |const|

返回此\ ``ArrayMesh``\ 中带有此名称的第一个曲面的索引。如果没有找到，则返回-1。

----

.. _class_ArrayMesh_method_surface_get_array_index_len:

- :ref:`int<class_int>` **surface_get_array_index_len** **(** :ref:`int<class_int>` surf_idx **)** |const|

返回请求的曲面的索引数组的长度，以指数为单位（参阅\ :ref:`add_surface_from_arrays<class_ArrayMesh_method_add_surface_from_arrays>`\ ）。

----

.. _class_ArrayMesh_method_surface_get_array_len:

- :ref:`int<class_int>` **surface_get_array_len** **(** :ref:`int<class_int>` surf_idx **)** |const|

返回所请求曲面中顶点数组的顶点长度（请参阅\ :ref:`add_surface_from_arrays<class_ArrayMesh_method_add_surface_from_arrays>`\ ）。

----

.. _class_ArrayMesh_method_surface_get_format:

- :ref:`int<class_int>` **surface_get_format** **(** :ref:`int<class_int>` surf_idx **)** |const|

返回所请求表面的格式掩码（请参阅\ :ref:`add_surface_from_arrays<class_ArrayMesh_method_add_surface_from_arrays>`\ ）。

----

.. _class_ArrayMesh_method_surface_get_name:

- :ref:`String<class_String>` **surface_get_name** **(** :ref:`int<class_int>` surf_idx **)** |const|

获取分配给此表面的名称。

----

.. _class_ArrayMesh_method_surface_get_primitive_type:

- :ref:`PrimitiveType<enum_Mesh_PrimitiveType>` **surface_get_primitive_type** **(** :ref:`int<class_int>` surf_idx **)** |const|

返回所请求曲面的基本类型（请参阅\ :ref:`add_surface_from_arrays<class_ArrayMesh_method_add_surface_from_arrays>`\ ）。

----

.. _class_ArrayMesh_method_surface_remove:

- void **surface_remove** **(** :ref:`int<class_int>` surf_idx **)**

移除位置\ ``surf_idx``\ 的一个面，将较大的面向下移动一个\ ``surf_idx``\ 槽。

----

.. _class_ArrayMesh_method_surface_set_name:

- void **surface_set_name** **(** :ref:`int<class_int>` surf_idx, :ref:`String<class_String>` name **)**

设置给定曲面的名称。

----

.. _class_ArrayMesh_method_surface_update_region:

- void **surface_update_region** **(** :ref:`int<class_int>` surf_idx, :ref:`int<class_int>` offset, :ref:`PoolByteArray<class_PoolByteArray>` data **)**

更新 GPU 上的网格数组的指定区域。

\ **警告：**\ 仅在知道您在做什么时使用。通过用不恰当的参数调用此功能，您可以轻松地导致崩溃。

.. |virtual| replace:: :abbr:`virtual (This method should typically be overridden by the user to have any effect.)`
.. |const| replace:: :abbr:`const (This method has no side effects. It doesn't modify any of the instance's member variables.)`
.. |vararg| replace:: :abbr:`vararg (This method accepts any number of arguments after the ones described here.)`
