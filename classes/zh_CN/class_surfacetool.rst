:github_url: hide

.. Generated automatically by doc/tools/make_rst.py in Godot's source tree.
.. DO NOT EDIT THIS FILE, but the SurfaceTool.xml source instead.
.. The source is found in doc/classes or modules/<name>/doc_classes.

.. _class_SurfaceTool:

SurfaceTool
===========

**Inherits:** :ref:`Reference<class_Reference>` **<** :ref:`Object<class_Object>`

创建几何图形的辅助工具。

描述
----

``SurfaceTool`` 用于通过单独指定顶点属性来构造 :ref:`Mesh<class_Mesh>`\ 。可以用来从脚本中构造 :ref:`Mesh<class_Mesh>`\ 。在调用 :ref:`add_vertex<class_SurfaceTool_method_add_vertex>` 之前，需要添加除索引之外的所有属性。例如，添加顶点颜色和 UV。

::

    var st = SurfaceTool.new()
    st.begin(Mesh.PRIMITIVE_TRIANGLES)
    st.add_color(Color(1, 0, 0))
    st.add_uv(Vector2(0, 0))
    st.add_vertex(Vector3(0, 0, 0))

上面的 ``SurfaceTool`` 现在包含了一个三角形的顶点，它有 UV 坐标和指定的 :ref:`Color<class_Color>`\ 。如果在没有调用 :ref:`add_uv<class_SurfaceTool_method_add_uv>` 或 :ref:`add_color<class_SurfaceTool_method_add_color>` 的情况下添加另一个顶点，那么就会使用最后的值。

顶点属性必须在调用 :ref:`add_vertex<class_SurfaceTool_method_add_vertex>` **之前**\ 传递。如果不这样做，在提交顶点信息到网格时将会导致错误。

此外，在添加第一个顶点之前使用的属性决定了网格的格式。例如，如果你只为第一个顶点添加 UV，你就不能为任何后续的顶点添加颜色。

参阅 :ref:`ArrayMesh<class_ArrayMesh>`\ 、\ :ref:`ImmediateGeometry<class_ImmediateGeometry>` 和 :ref:`MeshDataTool<class_MeshDataTool>` 以了解程序式几何体的生成。

\ **注意：**\ Godot 对三角形基本模式的正面使用顺时针\ `缠绕顺序 <https://learnopengl.com/Advanced-OpenGL/Face-culling>`__\ 。

教程
----

- `3D Voxel Demo <https://godotengine.org/asset-library/asset/676>`__

方法
----

+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`add_bones<class_SurfaceTool_method_add_bones>` **(** :ref:`PoolIntArray<class_PoolIntArray>` bones **)**                                                                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`add_color<class_SurfaceTool_method_add_color>` **(** :ref:`Color<class_Color>` color **)**                                                                                                                                                                                                                                                                                                                                                                                           |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`add_index<class_SurfaceTool_method_add_index>` **(** :ref:`int<class_int>` index **)**                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`add_normal<class_SurfaceTool_method_add_normal>` **(** :ref:`Vector3<class_Vector3>` normal **)**                                                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`add_smooth_group<class_SurfaceTool_method_add_smooth_group>` **(** :ref:`bool<class_bool>` smooth **)**                                                                                                                                                                                                                                                                                                                                                                              |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`add_tangent<class_SurfaceTool_method_add_tangent>` **(** :ref:`Plane<class_Plane>` tangent **)**                                                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`add_triangle_fan<class_SurfaceTool_method_add_triangle_fan>` **(** :ref:`PoolVector3Array<class_PoolVector3Array>` vertices, :ref:`PoolVector2Array<class_PoolVector2Array>` uvs=PoolVector2Array(  ), :ref:`PoolColorArray<class_PoolColorArray>` colors=PoolColorArray(  ), :ref:`PoolVector2Array<class_PoolVector2Array>` uv2s=PoolVector2Array(  ), :ref:`PoolVector3Array<class_PoolVector3Array>` normals=PoolVector3Array(  ), :ref:`Array<class_Array>` tangents=[  ] **)** |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`add_uv<class_SurfaceTool_method_add_uv>` **(** :ref:`Vector2<class_Vector2>` uv **)**                                                                                                                                                                                                                                                                                                                                                                                                |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`add_uv2<class_SurfaceTool_method_add_uv2>` **(** :ref:`Vector2<class_Vector2>` uv2 **)**                                                                                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`add_vertex<class_SurfaceTool_method_add_vertex>` **(** :ref:`Vector3<class_Vector3>` vertex **)**                                                                                                                                                                                                                                                                                                                                                                                    |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`add_weights<class_SurfaceTool_method_add_weights>` **(** :ref:`PoolRealArray<class_PoolRealArray>` weights **)**                                                                                                                                                                                                                                                                                                                                                                     |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`append_from<class_SurfaceTool_method_append_from>` **(** :ref:`Mesh<class_Mesh>` existing, :ref:`int<class_int>` surface, :ref:`Transform<class_Transform>` transform **)**                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`begin<class_SurfaceTool_method_begin>` **(** :ref:`PrimitiveType<enum_Mesh_PrimitiveType>` primitive **)**                                                                                                                                                                                                                                                                                                                                                                           |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`clear<class_SurfaceTool_method_clear>` **(** **)**                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :ref:`ArrayMesh<class_ArrayMesh>` | :ref:`commit<class_SurfaceTool_method_commit>` **(** :ref:`ArrayMesh<class_ArrayMesh>` existing=null, :ref:`int<class_int>` flags=2194432 **)**                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| :ref:`Array<class_Array>`         | :ref:`commit_to_arrays<class_SurfaceTool_method_commit_to_arrays>` **(** **)**                                                                                                                                                                                                                                                                                                                                                                                                             |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`create_from<class_SurfaceTool_method_create_from>` **(** :ref:`Mesh<class_Mesh>` existing, :ref:`int<class_int>` surface **)**                                                                                                                                                                                                                                                                                                                                                       |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`create_from_blend_shape<class_SurfaceTool_method_create_from_blend_shape>` **(** :ref:`Mesh<class_Mesh>` existing, :ref:`int<class_int>` surface, :ref:`String<class_String>` blend_shape **)**                                                                                                                                                                                                                                                                                      |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`deindex<class_SurfaceTool_method_deindex>` **(** **)**                                                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`generate_normals<class_SurfaceTool_method_generate_normals>` **(** :ref:`bool<class_bool>` flip=false **)**                                                                                                                                                                                                                                                                                                                                                                          |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`generate_tangents<class_SurfaceTool_method_generate_tangents>` **(** **)**                                                                                                                                                                                                                                                                                                                                                                                                           |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`index<class_SurfaceTool_method_index>` **(** **)**                                                                                                                                                                                                                                                                                                                                                                                                                                   |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| void                              | :ref:`set_material<class_SurfaceTool_method_set_material>` **(** :ref:`Material<class_Material>` material **)**                                                                                                                                                                                                                                                                                                                                                                            |
+-----------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

方法说明
--------

.. _class_SurfaceTool_method_add_bones:

- void **add_bones** **(** :ref:`PoolIntArray<class_PoolIntArray>` bones **)**

指定\ *下一个*\ 顶点所使用的骨骼数组。 ``bones`` 必须包含 4 个整数。

----

.. _class_SurfaceTool_method_add_color:

- void **add_color** **(** :ref:`Color<class_Color>` color **)**

指定\ *下一个*\ 顶点所使用的 :ref:`Color<class_Color>`\ 。如果每个顶点都需要设置此信息，而您未能为第一个顶点提交此信息，此信息可能根本就不会被使用。

\ **注意：**\ 材质必须启用\ :ref:`SpatialMaterial.vertex_color_use_as_albedo<class_SpatialMaterial_property_vertex_color_use_as_albedo>`\ 才能使顶点颜色可见。

----

.. _class_SurfaceTool_method_add_index:

- void **add_index** **(** :ref:`int<class_int>` index **)**

如果您使用索引顶点，则向索引数组添加索引。在添加顶点之前不需要调用。

----

.. _class_SurfaceTool_method_add_normal:

- void **add_normal** **(** :ref:`Vector3<class_Vector3>` normal **)**

指定\ *下一个*\ 顶点所使用的法线。如果每个顶点都需要设置此信息，而你没有为第一个顶点提交，则可能根本无法使用此信息。

----

.. _class_SurfaceTool_method_add_smooth_group:

- void **add_smooth_group** **(** :ref:`bool<class_bool>` smooth **)**

指定当前顶点（如果仅使用顶点数组）或当前索引（如果还使用索引数组）是否应使用平滑法线进行法线计算。

----

.. _class_SurfaceTool_method_add_tangent:

- void **add_tangent** **(** :ref:`Plane<class_Plane>` tangent **)**

指定\ *下一个*\ 顶点所使用的切线。如果每个顶点都需要设置此信息，而你没有为第一个顶点提交，则可能根本无法使用此信息。

----

.. _class_SurfaceTool_method_add_triangle_fan:

- void **add_triangle_fan** **(** :ref:`PoolVector3Array<class_PoolVector3Array>` vertices, :ref:`PoolVector2Array<class_PoolVector2Array>` uvs=PoolVector2Array(  ), :ref:`PoolColorArray<class_PoolColorArray>` colors=PoolColorArray(  ), :ref:`PoolVector2Array<class_PoolVector2Array>` uv2s=PoolVector2Array(  ), :ref:`PoolVector3Array<class_PoolVector3Array>` normals=PoolVector3Array(  ), :ref:`Array<class_Array>` tangents=[  ] **)**

将一个由数组数据组成的三角扇插入正在构建的 :ref:`Mesh<class_Mesh>` 中。

需要将基本类型设置为 :ref:`Mesh.PRIMITIVE_TRIANGLES<class_Mesh_constant_PRIMITIVE_TRIANGLES>`\ 。

----

.. _class_SurfaceTool_method_add_uv:

- void **add_uv** **(** :ref:`Vector2<class_Vector2>` uv **)**

指定\ *下一个*\ 顶点所使用的 UV 坐标。如果每个顶点都需要设置此信息，而您未能为第一个顶点提交此信息，此信息可能根本就不会被使用。

----

.. _class_SurfaceTool_method_add_uv2:

- void **add_uv2** **(** :ref:`Vector2<class_Vector2>` uv2 **)**

指定可选的第二组UV坐标，用于\ *next*\ 顶点。如果每个顶点都需要设置这个信息，而你没有为第一个顶点提交这个信息，此信息可能根本就不会被使用。

----

.. _class_SurfaceTool_method_add_vertex:

- void **add_vertex** **(** :ref:`Vector3<class_Vector3>` vertex **)**

指定当前顶点的位置。应在指定其他顶点属性（例如颜色、UV）后调用。

----

.. _class_SurfaceTool_method_add_weights:

- void **add_weights** **(** :ref:`PoolRealArray<class_PoolRealArray>` weights **)**

指定\ *下一个*\ 顶点所使用的权重值。 ``weights`` 必须包含 4 个值。如果每个顶点都需要设置此信息，而您未能为第一个顶点提交此信息，此信息可能根本就不会被使用。

----

.. _class_SurfaceTool_method_append_from:

- void **append_from** **(** :ref:`Mesh<class_Mesh>` existing, :ref:`int<class_int>` surface, :ref:`Transform<class_Transform>` transform **)**

将指定 :ref:`Mesh<class_Mesh>` 表面的顶点应用 :ref:`Transform<class_Transform>` 后，追加到当前的顶点数组中。

\ **注意：** 在 :ref:`Thread<class_Thread>` 中使用 :ref:`append_from<class_SurfaceTool_method_append_from>` 会更慢，因为 GPU 必须将数据送回 CPU，会把主线程暂停（因为 OpenGL 是线程不安全的）。请考虑先把该网格复制一份，转成 :ref:`ArrayMesh<class_ArrayMesh>` 后再手动添加顶点。

----

.. _class_SurfaceTool_method_begin:

- void **begin** **(** :ref:`PrimitiveType<enum_Mesh_PrimitiveType>` primitive **)**

在添加任何顶点之前被调用。接收原始类型作为参数（例如：原始三角形\ :ref:`Mesh.PRIMITIVE_TRIANGLES<class_Mesh_constant_PRIMITIVE_TRIANGLES>`\ ）。

----

.. _class_SurfaceTool_method_clear:

- void **clear** **(** **)**

清除到目前为止传入表面工具(surface tool)的所有信息。

----

.. _class_SurfaceTool_method_commit:

- :ref:`ArrayMesh<class_ArrayMesh>` **commit** **(** :ref:`ArrayMesh<class_ArrayMesh>` existing=null, :ref:`int<class_int>` flags=2194432 **)**

从传入的当前信息返回构造的 :ref:`ArrayMesh<class_ArrayMesh>`\ 。如果现有的 :ref:`ArrayMesh<class_ArrayMesh>` 作为参数传入，则会向现有的 :ref:`ArrayMesh<class_ArrayMesh>` 添加额外的面。

如果启用压缩，则默认标志为 :ref:`Mesh.ARRAY_COMPRESS_DEFAULT<class_Mesh_constant_ARRAY_COMPRESS_DEFAULT>`\ 。如果禁用压缩，则默认标志为 :ref:`Mesh.ARRAY_FLAG_USE_OCTAHEDRAL_COMPRESSION<class_Mesh_constant_ARRAY_FLAG_USE_OCTAHEDRAL_COMPRESSION>`\ 。有关其他标志，参阅 :ref:`ArrayFormat<enum_Mesh_ArrayFormat>` 中的 ``ARRAY_COMPRESS_*`` 常量。

----

.. _class_SurfaceTool_method_commit_to_arrays:

- :ref:`Array<class_Array>` **commit_to_arrays** **(** **)**

将数据提交给\ :ref:`ArrayMesh.add_surface_from_arrays<class_ArrayMesh_method_add_surface_from_arrays>`\ 使用的相同格式。这样你就可以使用\ :ref:`ArrayMesh<class_ArrayMesh>`\ 的API接口进一步处理网格数据。

----

.. _class_SurfaceTool_method_create_from:

- void **create_from** **(** :ref:`Mesh<class_Mesh>` existing, :ref:`int<class_int>` surface **)**

从现有的网格 :ref:`Mesh<class_Mesh>` 创建一个顶点数组。

----

.. _class_SurfaceTool_method_create_from_blend_shape:

- void **create_from_blend_shape** **(** :ref:`Mesh<class_Mesh>` existing, :ref:`int<class_int>` surface, :ref:`String<class_String>` blend_shape **)**

从现有 :ref:`Mesh<class_Mesh>` 的指定混合形状创建一个顶点数组。这可用于从混合形状中提取特定姿势。

----

.. _class_SurfaceTool_method_deindex:

- void **deindex** **(** **)**

通过扩展顶点数组移除索引数组。

----

.. _class_SurfaceTool_method_generate_normals:

- void **generate_normals** **(** :ref:`bool<class_bool>` flip=false **)**

从顶点生成法线，因此您不必手动执行。如果 ``flip`` 为 ``true``\ ，则生成的法线将被反转。 :ref:`generate_normals<class_SurfaceTool_method_generate_normals>` 应在生成几何体\ *之后* 调用，在\ *之前*\ 使用 :ref:`commit<class_SurfaceTool_method_commit>` 或 :ref:`commit_to_arrays<class_SurfaceTool_method_commit_to_arrays>` 提交网格。为了正确显示法线贴图表面，您还必须使用 :ref:`generate_tangents<class_SurfaceTool_method_generate_tangents>` 生成切线。

\ **注意：** :ref:`generate_normals<class_SurfaceTool_method_generate_normals>` 仅当基本类型设置为 :ref:`Mesh.PRIMITIVE_TRIANGLES<class_Mesh_constant_PRIMITIVE_TRIANGLES>` 时才有效。

----

.. _class_SurfaceTool_method_generate_tangents:

- void **generate_tangents** **(** **)**

为每个顶点生成切向量。要求每个顶点已经设置了 UV 和法线，参阅 :ref:`generate_normals<class_SurfaceTool_method_generate_normals>`\ 。

----

.. _class_SurfaceTool_method_index:

- void **index** **(** **)**

通过创建索引数组来缩小顶点数组。这可以避免顶点重复而提高性能。

----

.. _class_SurfaceTool_method_set_material:

- void **set_material** **(** :ref:`Material<class_Material>` material **)**

设置要由您正在构建的 :ref:`Mesh<class_Mesh>` 使用的 :ref:`Material<class_Material>`\ 。

.. |virtual| replace:: :abbr:`virtual (This method should typically be overridden by the user to have any effect.)`
.. |const| replace:: :abbr:`const (This method has no side effects. It doesn't modify any of the instance's member variables.)`
.. |vararg| replace:: :abbr:`vararg (This method accepts any number of arguments after the ones described here.)`
